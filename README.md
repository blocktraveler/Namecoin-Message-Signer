
# Namecoin Message Signer

## Website: [www.namecoin.pro](https://www.namecoin.pro) | Web3 ID: [https://dotbit.app](https://dotbit.app)

---

## Overview

This platform-independent tool provides a graphical user interface (GUI) for signing and verifying messages connecting to Namecoin Core descriptors, HD, and legacy wallets. It replicates Namecoin Core's native `signmessage` and `verifymessage` RPCs for legacy addresses while extending support to modern Bech32/SegWit addresses. Consequently, verifying ownership of assets assigned to Bech32 addresses no longer relies on on-chain verification strings.

The tool supports various address formats, including Bech32 (nc1...), legacy P2PKH (N... or M...), and P2SH (6...). For all types, the script solely performs internal signing/verification using derived private keys. This addresses the issue of various Namecoin software wallets generating different signatures due to their different native signing procedures (e.g., Namecoin Core v0.13.99 vs. v0.19). It retrieves the assigned address via the `name_show` RPC and supports a multilingual interface.

Place the script in the daemon folder (e.g., on Windows):

```
C:\Program Files\Namecoin\daemon
```

On-chain Archive:
-----------------
[nft/Namecoin_Message_Signer.zip](https://namecoin.online/explorer/details.php?q=nft%2FNamecoin_Message_Signer.zip)

Included Scripts:
-----------------
1. **Namecoin_Message_Signer.py** – The primary Tkinter-based GUI providing a user-friendly interface for signing and verifying messages via Namecoin Core RPCs. It handles user inputs (e.g., names, messages, signatures), displays real-time logs, and supports multilingual interfaces through JSON language files.

2. **crypto_utils.py** – A utility script with essential cryptographic functions, including Base58 encoding/decoding (with checksums), Bech32/SegWit address encoding, private key derivation (for HD wallets), hash utilities (e.g., SHA-256, RIPEMD-160), and ECDSA helpers (e.g., public key computation from private keys/WIF and recovery).

3. **signer.py** – The core backend script for loading descriptor wallets and performing message signing/verification using ECDSA on the secp256k1 curve (with double SHA-256 message hashing and deterministic signatures per RFC 6979) across various address types, including P2PKH Legacy, P2SH (wrapped SegWit), and Bech32 native SegWit.

Prerequisites:
-----------------
* Download and install Python 3.8+ from [python.org](https://www.python.org/downloads/).
* Install required libraries: `requests` and `ecdsa` (run: `pip install requests ecdsa`).
* Configure RPC credentials.

  On a fresh installation, create (otherwise edit) the file `namecoin.conf` in your Namecoin data directory with minimal content:

  **Windows:**
  ```
  server=1
  rpcallowip=127.0.0.1
  rpcbind=127.0.0.1
  rpccookiefile=.\.cookie
  rpcuser=xxxxxxxxxxxxxxx
  rpcpassword=xxxxxxxxxxx
  fallbackfee=0.0002
  ```

  **macOS:**
  ```
  server=1
  rpcallowip=127.0.0.1
  rpcbind=127.0.0.1
  rpccookiefile=.cookie
  rpcuser=xxxxxxxxxxxxxxx
  rpcpassword=xxxxxxxxxxx
  fallbackfee=0.0002
  ```

  The parameter `fallbackfee` is a recommended setting for the fallback fee calculation (0.0002 NMC).
  
  You can also just copy the predefined configuration file from the `config` folder.

  Data directory locations:

  - **Windows:** `%AppData%\Namecoin`
  - **macOS:** `~/Library/Application Support/Namecoin/` (Enable visibility with `command chflags nohidden ~/Library` in the terminal before.)
  - **Linux:** `$HOME/.namecoin/`

---

## Namecoin_Message_Signer.py

---

This Python script launches a separate graphical user interface (GUI) for signing messages with the private key of a Namecoin asset, as well as for verifying signatures against the corresponding public key (derived from the asset's address).

It supports:
- Legacy P2PKH (N..., M...), P2SH (6...), and Bech32 (nc1...) addresses.
- Automatic wallet type detection (descriptors, HD, legacy).
- Multilingual support with language selection on first run.

When running the script, Python creates a `__pycache__` directory in the project folder. This is standard and expected behavior for caching compiled bytecode to improve execution speed.

Key Features:
-------------
* **Address Retrieval**: Fetches address via `name_show` RPC.
* **Signing/Verification**: Handles legacy P2PKH, P2SH, and Bech32/SegWit via internal key derivation.
* **Inbound Compatibility**: Allows the verification of signatures generated by the native RPC `signmessage` of Namecoin Core v0.18 up to v0.27.1.
* **Outbound Compatibility**: For assets assigned to legacy addresses, signatures generated by this script are also compatible with the native RPC `verifymessage` of Namecoin Core v0.18 up to the latest version.
* **GUI Elements**: Input fields for name, message, signature; buttons for sign/verify; log window.
* **Background Loading**: Loads descriptors asynchronously to avoid GUI delay.
* **Security**: Limits message size to 1024 bytes; handles private keys ephemerally.

Dependencies:
-------------
* `requests` (RPC communication)
* `ecdsa` (elliptic curve key operations)
* `tkinter` (GUI, standard in Python)
* Python standard libraries (`hashlib`, `hmac`, `struct`, etc.)
* To install external libraries, run `pip install requests ecdsa` in the console.

Usage:
------
1. Set your RPC credentials (`rpc_user`, `rpc_pass`, `url`) in the main script.
2. Run: `python Namecoin_Message_Signer.py`
3. On first run: Select language (saves to `config.json`).
4. Enter Namecoin name (e.g., `d/example`), message, and (for verification) signature.
5. If you run your wallet in hex-mode, enter the hex-encoded name.
6. Note that any leading or trailing whitespaces or empty paragraphs will alter the string being verified!
7. Click Sign or Verify (buttons enable after loading the wallet).
8. View results in messagebox and log.
9. Make sure to use the same version of the Namecoin Message Signer for signing and verification!
10. To reset the GUI language, delete or modify the auto-generated `config.json` file.

Important Warnings:
-------------------
* **This script handles private keys via RPC/derivation. Only run on a trusted machine!**
* **Always maintain wallet backups!**

Limitations:
------------
* Assumes Namecoin's WIF prefix (`\xb4`) and P2SH prefix (`\x0d`).
* Message limit: 1024 bytes.
* No multisig support.
* Verification of messages signed with the private key of Bech32 addresses will fail on Namecoin Core v0.13.99, since SegWit was not yet activated in this version (500 Server Error will be thrown).

---

IMPORTANT: Handle all private keys and signatures with caution! Mishandling them may result in the loss of funds or assets. Use this tool responsibly.

---

DISCLAIMER: This script is provided "as is" without warranty of any kind, either expressed or implied. The author disclaims any responsibility or liability for any loss of funds, assets or data, or for any damage resulting from its use or misuse!

---
